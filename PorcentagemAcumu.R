tabela_final <- read.csv("D:/SADECK_DR/Area_Hexa/tabela_final.csv")
head(tabela_final)
colnames(tabela_final)

# Calcular a área restante (100% da célula disponível para desflorestamento)
tabela_final$area_restante <- tabela_final$A_C_km2 - (tabela_final$area_km2_hidr + tabela_final$area_km2_nf)

colnames(tabela_final)

# Renomear as colunas da tabela
colnames(tabela_final) <- gsub("^X", "", colnames(tabela_final))

# Criar uma nova tabela com as colunas renomeadas
table_pre <- tabela_final
colnames(table_pre)

# Excluir as colunas indesejadas
tabela_pre2 <- tabela_final[, !colnames(tabela_final) %in% c("A_C_km2", "area_km2_hidr", "area_km2_nf")]
colnames(tabela_pre2)

# Calcular a porcentagem para cada ano
anos <- as.character(1988:2023)  # Anos de 1988 a 2023

# Para cada ano, calcular a porcentagem
for (ano in anos) {
  tabela_pre2[[ano]] <- (tabela_pre2[[ano]] / tabela_pre2$area_restante) * 100
}

# Verificar os primeiros dados da tabela após o cálculo
head(tabela_pre2)


# Calcular o valor agregado por linha
for (i in 1:nrow(tabela_pre2)) {
  for (j in 2:length(anos)) {
    tabela_pre2[i, anos[j]] <- tabela_pre2[i, anos[j]] + tabela_pre2[i, anos[j-1]]
  }
}

head(tabela_pre2)

# Salvar a tabela em um arquivo CSV
write.csv(tabela_pre2, "tabela_pre2.csv", row.names = FALSE)

# Carregar a biblioteca ggplot2
library(ggplot2)

# Transformar a tabela para o formato longo (long format)
tabela_long <- reshape(tabela_pre2, 
                       varying = anos, 
                       v.names = "valor", 
                       timevar = "ano", 
                       times = anos, 
                       direction = "long")

# Criar o gráfico
ggplot(tabela_long, aes(x = as.numeric(ano), y = valor, group = id)) +
  geom_line() +
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10)) +
  labs(x = "Ano", y = "Valor (%)") +
  theme_minimal() +
  theme(legend.position = "none")  # Remover a legenda

#------------- Filtrar os dados para o id 812
tabela_id <- tabela_pre2[tabela_pre2$id == 47150, ]

# Transformar a tabela para o formato longo (long format)
tabela_long_id <- reshape(tabela_id, 
                           varying = anos, 
                           v.names = "valor", 
                           timevar = "ano", 
                           times = anos, 
                           direction = "long")

# Criar o gráfico para o id 812
ggplot(tabela_long_id, aes(x = as.numeric(ano), y = valor)) +
  geom_line() +
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10)) +
  labs(x = "Ano", y = "Valor (%)") +
  theme_minimal() +
  theme(legend.position = "none")  # Remover a legenda








#--------------- Defina a **lista** de ids que você quer visualizar 80 a 100%
ids_desejados <- c(56815,56928,57169,57145,53312,53278,53279,53280,53414,53415,53420,53419,53416,53417,53506,
                   53505,53733,53644,53645,53642,53643,53641,53870,53868,53869,53867,53763,53992,54097,54095,
                   54220,54219,54323,54866,55125,55095,55234,59414,59412,59413,59411,59422,59420,59421,59424,
                   59598,59599,59596,59597,59638,59639,59636,59646,59647,59644,59645,59643,59641,59628,59863,
                   59859,59857,59870,59871,59864,59865,59850,59878,59879,59876,59872,59873,59825,59820,60113,
                   60103,60101,60099,60110,60111,60108,60106,60104,60105,60052,60053,60083,60080,60093,60090,
                   60091,60078,60079,60077,60305,60316,60317,60301,60338,60327,60334,60335,60332,60333,60330,
                   60331,60328,60329,60503,60508,60506,60507,60505,60542,60543,60541,60566,60564,60565,60562,
                   60563,60561,60546,60547,60544,60545,60558,60557,60790,60791,60788,60789,60772,60770,60771,
                   60769,60783,60734,60735,60732,60733,60728,60729,61018,60998,60997,60959,60956,60955,60979,
                   60987,60985,60962,60960,60961,61182,61183,61203,61211,61188,61189,61186,61187,61184,61185,
                   61222,61220,61221,61219,61224,61402,61434,61414,61415,61413,61410,61411,61416,57372,57370,
                   57590,57597,57494,57519,57721,57622,57604,57821,57819,57845,57831,57826,57748,57778,58071,
                   58069,58064,58048,58049,58046,58047,58199,58200,58292,58296,58276,58274,58275,58273,58518,
                   58519,58517,58515,58522,58523,58502,58510,58508,58509,58750,58751,58732,58733,58730,58654,
                   58653,58879,58964,58972,58956,58978,58979,58977,58914,59106,59206,59140,59139,59198,59195,
                   59192,59366,59367,63702,63703,63700,63701,63698,63699,63696,63697,63710,63711,63707,63704,
                   63705,63686,63687,63694,63693,63690,63691,63712,63713,63670,63671,63668,63669,63830,63938,
                   63936,63937,63895,63927,63925,63930,63928,63929,63910,63911,63909,63916,63917,63914,63915,
                   63912,63913,64112,64110,64111,64146,64147,64144,64145,64158,64156,64157,64154,64155,64152,
                   64153,64142,64143,64140,64141,64138,64139,64136,64137,64164,64163,64161,64338,64339,64372,
                   64370,64371,64368,64369,64382,64380,64381,64378,64376,64352,64366,64367,64364,64365,64362,
                   64363,64390,64389,64598,64596,64597,64592,64593,64606,64607,64604,64605,64603,64600,64579,
                   64590,64591,64566,64792,64793,64822,64823,64820,64821,64818,64819,64816,64817,64824,64805,
                   64802,65020,65021,65046,65047,65044,65045,65043,65041,65052,65053,65050,65051,65048,65049,
                   65038,65032,65270,65271,65268,65269,65266,65264,65265,65278,65276,65277,65274,65275,65272,
                   65273,65494,65495,65502,65503,65500,65501,65498,65499,65487,65508,65506,65507,65504,65505,
                   61567,61447,61441,61451,61448,61449,61661,61638,61639,61637,61642,61640,61641,61669,61678,
                   61676,61674,61675,61673,61630,61629,61607,61798,61904,61905,61902,61903,61897,61886,61885,
                   61856,61868,61869,61867,62096,62095,62134,62133,62130,62128,62129,62118,62119,62116,62117,
                   62112,62113,62126,62127,62122,62123,62323,62335,62356,62352,62342,62341,62336,62350,62351,
                   62348,62344,62549,62532,62583,62578,62577,62566,62563,62560,62570,62571,62807,62800,62801,
                   62790,62791,62788,62789,62797,62792,62782,62758,62759,62762,62913,62974,62973,63004,62983,
                   62986,62985,63029,63027,63024,63025,63014,63013,63009,63022,63018,63019,63016,63216,63231,
                   63200,63215,63212,63213,63211,63252,63253,63250,63251,63248,63249,63239,63246,63242,63243,
                   63240,63444,63442,63441,63427,63438,63439,63478,63479,63476,63475,63472,63473,63483,63460,
                   63458,63459,63457,63470,63468,63469,63464,34901,34904,34916,34915,34912,34913,34920,35143,
                   35148,35149,35147,35132,35131,35376,35362,35374,35375,35373,35371,35604,35602,35603,35601,
                   35830,35828,35829,36059,36056,36286,36285,36283,36510,36512,36513,36738,36739,32854,32855,
                   32862,32863,32858,32859,32856,32857,32868,32866,32864,32865,33092,33090,33091,33089,33086,
                   33084,33085,33083,33080,33081,33310,33309,33318,33319,33316,33317,33312,33535,33542,33540,
                   33541,33538,33539,33537,33546,33544,33545,33777,33766,33767,33764,33763,33773,33770,33771,
                   33768,33769,34000,34001,33986,33999,33996,33994,33995,33993,34228,34237,34222,34223,34452,
                   34450,34448,34449,34465,34676,34677,34687,34693,39029,39036,39034,39021,38968,39254,39255,
                   39250,39259,39257,39195,39486,39484,39483,39480,39481,39587,39710,39708,39709,39707,39714,
                   39713,39879,39876,39934,39935,39942,39943,39938,40166,40167,40165,40172,40170,40171,40104,
                   40391,40396,40397,40392,40393,40558,40557,40620,40621,40618,40619,40617,40848,40846,40847,
                   40844,40845,36986,36985,36967,36975,37204,37214,37211,37446,37443,37440,37441,37439,37654,
                   37653,37663,37668,37666,37665,37673,37768,37769,38108,38109,38105,38118,38114,38115,38125,
                   38122,38123,38120,38343,38340,38336,38350,38351,38605,38577,38565,38575,38570,38568,38806,
                   38804,38805,38803,38810,38796,43120,43119,43116,43117,43114,43115,43112,43113,43063,43346,
                   43344,43345,43342,43343,43340,43341,43337,43438,43572,43573,43570,43571,43566,43567,43564,
                   43562,43563,43792,43984,43992,44018,44016,44247,44244,44243,44212,44211,44208,44209,44434,
                   44435,44470,44471,44469,44662,44663,44650,44701,44698,44697,44890,44889,44924,44922,44923,
                   44907,44802,41032,41033,41076,41074,41075,41072,41073,41071,41302,41300,41301,41298,41299,
                   41258,41259,41256,41257,41484,41485,41483,41526,41527,41530,41531,41528,41529,41712,41711,
                   41756,41757,41754,41755,41752,41753,41928,41982,41983,41980,41981,42081,41984,41985,42207,
                   42212,42210,42211,42208,42209,42172,42438,42439,42436,42437,42434,42435,42433,42440,42623,
                   42536,42662,42663,42660,42661,42658,42670,42666,42664,42665,42852,42898,42886,42887,42892,
                   42893,42890,42891,42888,42889,47370,47371,47866,47841,48068,48069,48055,48053,48056,48223,
                   48201,48286,48282,48281,48306,48449,48508,48507,48424,48514,48513,48735,48752,48761,48742,
                   48741,48878,48877,48987,48963,45151,45156,45152,45153,45118,45116,45117,45256,45382,45380,
                   45381,45378,45379,45377,45558,45606,45607,45604,45605,45603,45612,45608,45796,45707,45830,
                   45831,45829,45834,45833,46060,46061,46058,46059,46056,46057,46272,46286,46287,46284,46285,
                   46283,46262,46261,46252,46480,46489,46466,46514,46512,46501,46511,46718,46715,46692,46738,
                   46727,46722,46728,46943,18543,18773,18998,19213,16502,16501,16727,16728,16729,16960,16959,
                   16957,17179,17414,17640,17862,17867,17865,18082,18307,23318,23317,23542,23545,23770,24448,
                   26718,26719,26717,26964,26965,26948,26949,26946,26947,26945,27166,27167,27190,27175,27172,
                   27173,27170,27171,27385,27418,27398,27399,27394,27393,27400,27401,27647,27622,27628,27626,
                   27627,27857,27854,27853,27873,28100,28098,28083,28080,28079,28076,28310,28302,28326,28327,
                   28537,28527,24676,24677,24675,24904,25126,25127,25125,25132,25128,25352,26039,26040,26266,
                   26267,26265,26495,26493,26489,30806,30807,30815,30812,30810,30811,30808,30809,31042,31040,
                   31041,31048,31049,31024,31038,31039,31036,31037,31034,31035,31033,31255,31248,31249,31262,
                   31263,31260,31261,31259,31257,31271,31268,31269,31266,31267,31264,31265,31272,31479,31486,
                   31487,31484,31485,31483,31494,31495,31492,31493,31490,31491,31488,31489,31502,31500,31501,
                   31498,31496,31497,31702,31711,31709,31707,31728,31718,31719,31716,31717,31714,31715,31712,
                   31713,31726,31727,31724,31725,31722,31723,31720,31721,31956,31952,31942,31943,31941,31939,
                   31937,31950,31951,31948,31949,31946,31947,31944,31945,32182,32183,32181,32176,32177,32186,
                   32184,32185,32167,32163,32174,32175,32172,32173,32170,32171,32168,32169,32404,32402,32403,
                   32400,32401,32414,32412,32410,32411,32408,32409,32398,32399,32396,32397,32394,32395,32420,
                   32630,32631,32628,32629,32626,32627,32624,32625,32638,32639,32636,32637,32635,32614,32615,
                   32622,32621,32640,32641,28757,28762,28760,28781,28981,28989,29234,29233,29460,29459,29446,
                   29686,29687,29669,29667,29674,29904,29913,29900,29901,29899,30134,30133,30130,30131,30128,
                   30129,30127,30359,30356,30357,30354,30355,30353,30366,30367,30351,30368,30582,30580,30581,
                   30579,30586,30587,30584,30585,30594,30595,30593,67782,67783,67780,67781,67778,67779,67777,
                   67788,67789,67786,67787,67784,67785,67732,67731,67766,67767,67764,67765,67762,67763,67761,
                   67774,67770,67771,67768,67769,67751,67746,67747,67744,67745,67758,67759,67757,67958,67937,
                   67990,67991,67988,67989,67986,67987,67984,67985,67996,67994,67992,67993,67974,67973,67983,
                   68016,68006,68007,68004,68005,68002,68003,68001,68014,68015,68012,68013,68010,68011,68008,
                   68009,68214,68212,68213,68211,68208,68209,68222,68220,68221,68218,68219,68207,68246,68247,
                   68244,68245,68242,68243,68240,68241,68248,68249,68230,68228,68229,68226,68227,68238,68239,
                   68236,68237,68234,68235,68233,68438,68439,68437,68434,68435,68433,68446,68447,68444,68445,
                   68440,68441,68470,68471,68468,68469,68466,68467,68465,68472,68454,68455,68452,68453,68450,
                   68448,68449,68458,68456,68693,68678,68679,68676,68677,68674,68675,68672,68673,68686,68684,
                   68685,68682,68683,68680,68681,68662,68663,68660,68661,68658,68671,68668,68666,68667,68664,
                   68850,68849,68886,68887,68894,68895,68893,68890,68891,68888,68912,68903,68901,68897,68910,
                   68911,68908,68909,68906,68907,68904,68905,69077,69118,69119,69116,69117,69114,69115,69138,
                   69136,69137,69127,69122,69123,69121,69134,69135,69132,69133,69131,69128,69342,69343,69340,
                   69341,69339,69364,69362,69363,69350,69351,69348,69349,69347,69344,69345,69358,69359,69357,
                   69354,69355,69352,69588,69587,69584,69585,69575,69572,69573,69570,69571,69569,69582,69583,
                   69580,69581,69578,69542,65734,65732,65733,65730,65731,65728,65729,65714,65726,65727,65725,
                   65722,65720,65721,65696,65697,65711,65941,65950,65951,65948,65949,65946,65947,65924,65925,
                   65922,65923,65972,65959,65956,65957,65955,65952,65953,65960,65961,66167,66160,66174,66175,
                   66172,66173,66150,66148,66149,66198,66199,66196,66197,66192,66180,66181,66179,66176,66190,
                   66191,66188,66189,66186,66184,66399,66397,66394,66395,66392,66382,66381,66421,66418,66416,
                   66417,66424,66425,66406,66402,66403,66400,66401,66414,66413,66410,66411,66408,66409,66646,
                   66647,66644,66645,66642,66643,66640,66641,66650,66648,66649,66630,66631,66628,66629,66626,
                   66627,66625,66632,66633,66613,66609,66622,66620,66621,66618,66617,66604,66838,66836,66837,
                   66834,66832,66833,66846,66847,66844,66845,66840,66870,66871,66864,66865,66874,66875,66872,
                   66873,66854,66855,66852,66851,66848,66862,66860,66858,66859,66856,66857,67062,67060,67061,
                   67059,67071,67066,67067,67065,67094,67090,67088,67089,67102,67100,67101,67098,67099,67096,
                   67078,67079,67074,67072,67073,67086,67087,67084,67085,67082,67083,67080,67081,67286,67284,
                   67285,67282,67283,67294,67295,67292,67293,67290,67291,67316,67317,67312,67313,67326,67327,
                   67324,67325,67323,67300,67301,67298,67299,67297,67310,67311,67308,67309,67306,67304,67305,
                   67330,67328,67329,67542,67543,67540,67541,67538,67539,67536,67537,67550,67546,67547,67524,
                   67522,67521,67534,67535,67533,67531,67558,67559,67556,67554,67555,67552,67553,67510,67506,
                   67507,67504,67518,67519,67516,67517,67512,67503,71806,71807,71800,71801,71829,71825,71838,
                   71839,71836,71837,71834,71835,71832,71833,71811,71808,71809,71822,71823,71818,71817,71840,
                   72031,72028,72029,72027,72054,72055,72052,72049,72062,72063,72060,72061,72057,72034,72035,
                   72032,72033,72045,72041,72066,72067,72064,72065,72276,72282,72283,72262,72263,72260,72261,
                   72258,72259,72266,72264,72294,72295,72292,72293,72290,72291,72288,72289,72255,72252,72253,
                   72518,72519,72516,72517,72514,72515,72512,72513,72522,72520,72521,72502,72486,72484,72485,
                   72482,72483,72480,72481,72493,72488,72489,72710,72711,72708,72709,72707,72718,72719,72716,
                   72717,72714,72715,72712,72713,72742,72743,72740,72741,72739,72750,72748,72749,72746,72747,
                   72744,72745,72946,72947,72944,72945,72952,72934,72935,72932,72933,72942,72943,72938,72939,
                   72936,72937,72976,72967,72974,72975,72972,72973,72970,72971,72968,72969,73170,73159,73166,
                   73167,73164,73165,73162,73163,73160,73161,73202,73203,73200,73201,73198,73199,73196,73194,
                   73195,73430,73427,73424,73425,73422,73423,73420,73421,73392,73393,73405,73390,73391,73388,
                   73386,73387,73620,73621,73618,73619,73616,73617,73614,73615,73650,73651,73648,73649,73633,
                   73647,69755,69790,69791,69810,69808,69809,69798,69799,69796,69797,69792,69793,69983,69984,
                   69996,70038,70022,70023,70020,70021,70019,70026,70027,70024,70210,70209,70218,70219,70246,
                   70247,70245,70254,70252,70253,70250,70251,70248,70249,70469,70478,70476,70477,70474,70475,
                   70472,70473,70438,70437,70435,70440,70667,70664,70665,70704,70705,70694,70695,70702,70703,
                   70699,70696,70903,70897,70894,70892,70893,70891,70932,70930,70929,70918,70927,70922,70923,
                   70920,71126,71127,71124,71125,71120,71132,71130,71131,71128,71118,71119,71116,71117,71158,
                   71159,71156,71157,71154,71155,71152,71136,71150,71151,71148,71146,71147,71382,71383,71380,
                   71381,71378,71379,71376,71377,71386,71384,71385,71364,71362,71374,71375,71373,71371,71351,
                   71348,71346,71347,71345,71358,71359,71356,71357,71354,71355,71352,71353,71574,71575,71573,
                   71582,71580,71581,71606,71607,71604,71605,71602,71601,71612,71610,71611,71608,71609,71590,
                   71591,71589,71584,71598,71597,71594,71592,71593,75894,75895,75893,75902,75900,75901,75898,
                   75899,75896,75897,75924,75923,75920,75910,75911,75908,75909,75906,75904,75916,75917,75914,
                   75915,75912,75913,76119,76126,76127,76124,76125,76122,76123,76120,76121,76150,76146,76144,
                   76134,76135,76133,76130,76131,76129,76142,76143,76140,76141,76138,76139,76136,76137,76370,
                   76371,76368,76369,76377,76358,76356,76357,76355,76352,76353,76366,76367,76364,76365,76362,
                   76363,76360,76361,76350,76351,76348,76349,76347,76575,76598,76596,76597,76594,76595,76592,
                   76593,76582,76583,76580,76581,76579,76576,76590,76591,76588,76589,76586,76587,76585,76798,
                   76797,76822,76823,76820,76821,76818,76819,76816,76817,76826,76824,76825,76802,76803,76814,
                   76815,76812,76813,76810,76811,76808,76809,77046,77047,77044,77045,77042,77043,77040,77041,
                   77052,77053,77050,77051,77048,77049,77030,77028,77029,77026,77024,77025,77038,77039,77036,
                   77037,77034,77035,77270,77271,77268,77269,77266,77267,77264,77265,77278,77279,77276,77277,
                   77274,77275,77273,77254,77262,77263,77261,77257,77280,77281,77508,77509,77506,77507,77504,
                   77494,77492,77493,77490,77491,77488,77489,77502,77503,77500,77501,77498,77499,77496,77497,
                   77481,77718,77719,77716,77715,77712,77726,77727,77725,77722,77721,77710,77734,77735,77732,
                   77733,77730,77728,77729,77736,73846,73847,73844,73845,73842,73843,73841,73877,73874,73875,
                   74070,74071,74069,74072,74102,74103,74101,74104,74105,74326,74327,74332,74330,74331,74328,
                   74329,74295,74298,74296,74523,74546,74547,74556,74557,74554,74555,74553,74535,74529,74536,
                   74772,74773,74771,74782,74783,74780,74781,74779,74761,74784,75006,75007,75001,74988,74986,
                   74987,75012,75013,75008,75009,75216,75231,75228,75226,75227,75225,75214,75215,75212,75213,
                   75210,75211,75238,75239,75237,75234,75232,75240,75472,75462,75463,75460,75461,75458,75459,
                   75456,75468,75466,75467,75464,75465,75444,75445,75442,75443,75440,75441,75454,75455,75453,
                   75438,75439,75436,75437,75670,75671,75668,75669,75666,75667,75679,75672,75673,75663,75698,
                   75696,75697,75686,75687,75684,75685,75682,75683,75680,75681,75694,75695,75692,75693,75690,
                   75688,75689,80439,15147,77942,77940,77941,77938,77948,77949,77946,77947,77944,77945,77934,
                   77932,77933,77958,77959,77956,77957,77954,77955,77952,77953,77962,77960,78162,78160,78161,
                   78174,78175,78172,78173,78171,78168,78182,78183,78180,78181,78179,78176,78190,78188,78186,
                   78187,78184,78185,78406,78407,78402,78400,78414,78412,78410,78411,78408,78388,78389,78387,
                   78398,78399,78396,78397,78393,78622,78623,78618,78619,78616,78617,78640,78641,78628,78626,
                   78627,78624,78625,78638,78639,78636,78637,78635,78632,78633,78844,78845,78843,78864,78865,
                   78852,78853,78850,78848,78849,78862,78863,78860,78858,78859,79071,79090,79091,79089,79079,
                   79072,79086,79080,79312,79313,79311,79538,79539,79765,51259,51238,51236,51237,51234,51235,
                   51233,51379,51475,51487,51462,51463,51460,51461,51464,51490,51702,51686,51693,51690,51603,
                   51830,51828,51829,51838,51716,51714,51713,51918,51919,51840,52055,52062,52056,52057,52064,
                   52065,52292,52293,52283,52378,52377,52599,52604,52605,52510,52511,52826,52834,52847,52739,
                   52736,52737,52964,52962,52963,53188,53189,53192,53193,49212,49213,49210,49211,49190,49188,
                   49189,49197,49194,49195,49424,49425,49439,49437,49432,49422,49423,49416,49652,49650,49651,
                   49663,49659,49647,49564,49878,49879,49874,49875,49873,49868,49890,49891,49889,50102,50103,
                   50101,50106,50104,50105,50327,50332,50333,50330,50331,50328,50329,50354,50551,50558,50556,
                   50557,50555,50552,50560,50782,50783,50778,50757,50787,50784,51015,51012,51010,51011,51008,
                   51009,51007,51004,51005,50988,50986,51197,56032,56033,56488)

# Filtrar os dados para os ids desejados
tabela_ids_filtrados <- tabela_pre2[tabela_pre2$id %in% ids_desejados, ]

# Transformar a tabela para o formato longo (long format)
tabela_long_filtrada <- reshape(tabela_ids_filtrados, 
                                varying = anos, 
                                v.names = "valor", 
                                timevar = "ano", 
                                times = anos, 
                                direction = "long")

# Criar o gráfico para os ids selecionados
ggplot(tabela_long_filtrada, aes(x = as.numeric(ano), y = valor, group = id)) +
  geom_line() +
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10)) +
  labs(x = "Ano", y = "Valor (%)") +
  theme_minimal() +
  theme(legend.position = "none")  # Remover a legenda


# Remover valores ausentes ou fora do intervalo
tabela_long_filtrada <- tabela_long_filtrada %>%
  filter(!is.na(valor) & valor >= 0 & valor <= 100)

# Calcular a média por ano
tabela_media <- tabela_long_filtrada %>%
  group_by(ano) %>%
  summarise(media_valor = mean(valor, na.rm = TRUE))

head(tabela_media)

# Criar o gráfico
ggplot() + 
  geom_line(data = tabela_long_filtrada, 
            aes(x = as.numeric(ano), y = valor, group = id), 
            alpha = 0.5) +  # Linhas individuais com transparência
  geom_line(data = tabela_media, 
            aes(x = as.numeric(ano), y = media_valor), 
            color = "red", linewidth = 1.2) +  # Linha média em vermelho
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10)) +
  labs(x = "Ano", y = "Valor (%)") +
  theme_minimal() +
  theme(legend.position = "none")  # Remover a legenda







# Carregue os pacotes
library(sf)
library(ggplot2)
library(tidyr)
library(dplyr)

#--------------- Carregar o shapefile
shapefile <- "C:/Users/luis.sadeck.COEAM/Downloads/hexa10perc.shp" # Substitua pelo caminho do shapefile
dados_shp <- st_read(shapefile)

# 2. Visualizar os nomes das colunas no shapefile
names(dados_shp)

# 2. Selecionar as colunas de interesse
colunas_temporais <- grep("^tabela_p", names(dados_shp), value = TRUE)  # Seleciona as colunas com 'tabela_p'
names(colunas_temporais)

unique(dados_longos$variavel)

dados_longos <- dados_shp %>%
  st_drop_geometry() %>%
  pivot_longer(
    cols = all_of(colunas_temporais),
    names_to = "variavel",
    names_prefix = "tabela_p",
    values_to = "valor"
  )


# 4. Criar o gráfico de linhas
ggplot(dados_longos, aes(x = variavel, y = valor, group = id, color = factor(id))) +
  geom_line() +
  labs(
    title = "Gráfico de Linhas a partir do Shapefile",
    x = "Variável Temporal",
    y = "Valor",
    color = "ID"
  ) +
  theme_minimal() +
  theme(legend.position = "none")  # Remover a legenda


##------------------------------------------------



# Selecionar os anos de 1990 a 1999 e a coluna ID
anos_selecionados <- c("id", as.character(1990:1999))

# Criar a nova tabela
tabela_90_99 <- tabela_pre2[, anos_selecionados]

# Verificar os primeiros dados
head(tabela_90_99)

# Salvar em um arquivo CSV, se necessário
write.csv(tabela_90_99, "tabela_90_99.csv", row.names = FALSE)


# Filtrar os IDs que atendem aos critérios: 1990 >= 10% e 1999 <= 100%
tabela_filtrada90 <- tabela_90_99[tabela_90_99$`1990` >= 10 & tabela_90_99$`1999` <= 100, ]

# Transformar a tabela para o formato longo (long format)
tabela_long_filtrada90 <- reshape(tabela_filtrada90, 
                                varying = as.character(1990:1999), 
                                v.names = "valor", 
                                timevar = "ano", 
                                times = as.character(1990:1999), 
                                direction = "long")

# Calcular a média dos valores por ano
tabela_media90 <- aggregate(valor ~ ano, data = tabela_long_filtrada90, FUN = mean)
colnames(tabela_media90)[2] <- "media_valor"  # Renomear a coluna de média

# Criar o gráfico
ggplot() + 
  geom_line(data = tabela_long_filtrada90, 
            aes(x = as.numeric(ano), y = valor, group = id), 
            alpha = 0.5) +  # Linhas individuais com transparência
  geom_line(data = tabela_media90, 
            aes(x = as.numeric(ano), y = media_valor), 
            color = "red", linewidth = 1.2) +  # Linha média em vermelho
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10)) +
  labs(x = "Ano", y = "Valor (%)") +
  theme_minimal() +
  theme(legend.position = "none")  # Remover a legenda





